(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{35:function(t,n,e){"use strict";e.r(n);var r=e(1),c=e(0),i=e(20),o=e.n(i),a=e(9),u=e(5),s=e(4),j=e(10),b=e(2),d="token",l=function(t){localStorage.setItem(d,t)},f=function(){return localStorage.getItem(d)},O="https://student-json-api.lidemy.me",h=function(){var t=f();return fetch("".concat(O,"/me"),{method:"GET",headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))};function p(){var t=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return p=function(){return t},t}function x(){var t=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return x=function(){return t},t}function v(){var t=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 55, 21, 0.5);\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  padding: 16px;\n"]);return v=function(){return t},t}function g(){var t=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return g=function(){return t},t}var m=s.b.div(g()),y=s.b.div(v()),S=Object(s.b)(j.b)(x()),w=s.b.div(p());function k(t){var n=t.post;return Object(r.jsxs)(y,{children:[Object(r.jsx)(S,{to:"/posts/".concat(n.id),children:n.title}),Object(r.jsx)(w,{children:new Date(n.createdAt).toLocaleString()})]})}function C(){var t=Object(c.useState)([]),n=Object(a.a)(t,2),e=n[0],i=n[1];return Object(c.useEffect)((function(){fetch("".concat(O,"/posts?_sort=createdAt&_order=desc")).then((function(t){return t.json()})).then((function(t){return i(t)}))}),[]),Object(r.jsx)(m,{children:e.map((function(t){return Object(r.jsx)(k,{post:t},t.id)}))})}var z=Object(c.createContext)(null),P=Object(c.createContext)(!1);function $(){var t=Object(u.a)(["\n  color: red;\n"]);return $=function(){return t},t}var _=s.b.div($());function E(){var t=Object(c.useState)(""),n=Object(a.a)(t,2),e=n[0],i=n[1],o=Object(c.useState)(""),u=Object(a.a)(o,2),s=u[0],j=u[1],d=Object(c.useState)(""),f=Object(a.a)(d,2),p=f[0],x=f[1],v=Object(b.f)(),g=Object(c.useContext)(z).setUser;return Object(r.jsxs)("form",{onSubmit:function(t){x(null),function(t,n){return fetch("".concat(O,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})}).then((function(t){return t.json()}))}(e,s).then((function(t){if(0===t.ok)return x(t.message);l(t.token),h().then((function(t){if(1!==t.ok)return l(null),x(t.toString());g(t.data),v.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username:",Object(r.jsx)("input",{value:e,onChange:function(t){return i(t.target.value)}})]}),Object(r.jsxs)("div",{children:["password:",Object(r.jsx)("input",{type:"password",value:s,onChange:function(t){return j(t.target.value)}})]}),Object(r.jsx)("input",{type:"submit",value:"\u767b\u5165"}),p&&Object(r.jsx)(_,{children:p})]})}function F(){var t=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  // \u5982\u679c $active \u662f true\uff0c\u624d\u6703\u6709 background-color\n  ","\n"]);return F=function(){return t},t}function I(){var t=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]);return I=function(){return t},t}function T(){var t=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  "," {\n    margin-left: 64px;\n  }\n"]);return T=function(){return t},t}function B(){var t=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 64px;\n  box-sizing: border-box;\n"]);return B=function(){return t},t}function J(){var t=Object(u.a)(["\n  height: 64px;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0 24px;\n  box-sizing: border-box;\n"]);return J=function(){return t},t}var L=s.b.div(J()),U=s.b.div(B()),A=s.b.div(T(),U),D=s.b.div(I()),G=Object(s.b)(j.b)(F(),(function(t){return t.$active&&"\n    background-color: rgba(202, 68, 111, 0.1);\n  "}));function N(){var t=Object(b.g)(),n=Object(c.useContext)(z),e=n.user,i=n.setUser,o=Object(b.f)(),a=Object(c.useContext)(P);return Object(r.jsxs)(L,{children:[Object(r.jsxs)(A,{children:[Object(r.jsx)(D,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(r.jsxs)(U,{children:[Object(r.jsx)(G,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),!a&&e&&Object(r.jsx)(G,{to:"/new-post",$active:"/new-post"===t.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(U,{children:[!a&&!e&&Object(r.jsx)(G,{to:"/login",$active:"/login"===t.pathname,children:"\u767b\u5165"}),!a&&e&&Object(r.jsx)(G,{onClick:function(){l(""),i(null),"/"!==t.pathname&&o.push("/")},children:"\u767b\u51fa"})]})]})}function q(){var t=Object(u.a)(["\n  padding-top: 64px;\n"]);return q=function(){return t},t}var H=s.b.div(q());var K=function(){var t=Object(c.useState)(null),n=Object(a.a)(t,2),e=n[0],i=n[1],o=Object(c.useState)(!1),u=Object(a.a)(o,2),s=u[0],d=u[1];return Object(c.useEffect)((function(){f()&&(d(!0),h().then((function(t){d(!1),1===t.ok&&i(t.data)})))}),[]),Object(r.jsx)(z.Provider,{value:{user:e,setUser:i},children:Object(r.jsx)(H,{children:Object(r.jsxs)(j.a,{children:[Object(r.jsx)(P.Provider,{value:s,children:Object(r.jsx)(N,{})}),Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/",children:Object(r.jsx)(C,{})}),Object(r.jsx)(b.a,{exact:!0,path:"/login",children:Object(r.jsx)(E,{})})]})]})})})},M=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,36)).then((function(n){var e=n.getCLS,r=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;e(t),r(t),c(t),i(t),o(t)}))};o.a.render(Object(r.jsx)(s.a,{theme:{colors:{primary_300:"#ef9898",primary_400:"#ec6b6b",primary_500:"#ea1212"}},children:Object(r.jsx)(K,{})}),document.getElementById("root")),M()}},[[35,1,2]]]);
//# sourceMappingURL=main.82624de2.chunk.js.map